function generateTopAlertsTable(a,e=1,t=10,r="top_alerts"){const i=a.filter((a=>["Critical","High","Medium","Low","Informational"].includes(a.risk_category))),l={};i.forEach((a=>{const{subject:e,risk_category:t}=a,r=`${e}_${t}`;l[r]=(l[r]||0)+1}));const n=Object.keys(l).map((a=>{const[e,t]=a.split("_");return{subject:e,risk_category:t,count:l[a]}}));n.sort(((a,e)=>{const t=["Critical","High","Medium","Low","Informational"],r=t.indexOf(a.risk_category),i=t.indexOf(e.risk_category);return r!==i?r-i:e.count-a.count}));const s=Math.ceil(n.length/t),c=Math.max(1,e-2),o=Math.min(c+4,s),g=(e-1)*t,d=g+t,u=n.slice(g,d);let b='<table class="table table-striped" id="paginated-list" data-current-page="'+e+'">';b+="<tr><th>Vulnerability Name</th><th>Risk Category</th><th>Count</th></tr>",u.forEach((a=>{let e;switch(a.risk_category){case"Critical":e="rgba(112,48,160,0.5)";break;case"High":e="rgba(192,1,0,0.5)";break;case"Medium":e="rgba(255,153,50,0.5)";break;case"Low":e="rgba(255,204,3,0.5)";break;case"Informational":e="rgba(153,204,2,0.5)";break;default:e=""}b+=`<tr><td>${a.subject}</td><td style="background-color: ${e}">${a.risk_category}</td><td>${a.count}</td></tr>`})),b+="</table>";let p='<nav class="d-xl-flex justify-content-xl-end">';p+='<ul class="pagination pagination-sm">',p+=`<li class="page-item ${1===e?"disabled":""}"><a class="page-link" aria-label="Previous" href="#" data-page="${e-1}"><span aria-hidden="true">«</span></a></li>`;for(let a=c;a<=o;a++)p+=`<li class="page-item ${e===a?"active":""}"><a class="page-link" href="#" data-page="${a}">${a}</a></li>`;p+=`<li class="page-item ${e===s?"disabled":""}"><a class="page-link" aria-label="Next" href="#" data-page="${e+1}"><span aria-hidden="true">»</span></a></li>`,p+="</ul></nav>",document.getElementById(r).innerHTML=b+p;document.querySelectorAll(`#${r} .pagination a`).forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const i=parseInt(this.getAttribute("data-page"));generateTopAlertsTable(a,i,t,r)}))}))}window.generateTopAlertsTable=generateTopAlertsTable;