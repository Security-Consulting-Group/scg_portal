let myChart;function fetchReportAndDrawChart(t){fetch(`/uploads/nessus/${t}_betdsi.json`).then((t=>t.json())).then((t=>{drawChart(calculateCounts(t.alert_report))})).catch((t=>console.error("Error fetching or parsing data:",t)))}function calculateCounts(t){const r={Critical:0,High:0,Medium:0,Low:0,Informational:0};return t.forEach((t=>{r[t.risk_category]++})),r}function drawChart(t){myChart&&myChart.destroy();const r=Object.keys(t),a=Object.values(t),e={Critical:"rgba(112,48,160,0.5)",High:"rgba(192,1,0,0.5)",Medium:"rgba(255,153,50,0.5)",Low:"rgba(255,204,3,0.5)",Informational:"rgba(153,204,2,0.5)"},o={type:"bar",data:{labels:r,datasets:[{data:a,backgroundColor:r.map((t=>e[t])),borderWidth:1,borderColor:["rgb(112,48,160)","rgb(192,1,0)","rgb(255,153,50)","rgb(255,204,3)","rgb(153,204,2)"],barThickness:40}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{stacked:!0,ticks:{beginAtZero:!0,color:"black"},grid:{color:"rgba(0, 0, 0, 0.1)"}},y:{stacked:!0,ticks:{color:"black"},grid:{color:"rgba(0, 0, 0, 0.1)"}}},layout:{padding:{left:5,right:50,top:0,bottom:0}}}};Chart.defaults.font.size=12;const n=document.getElementById("vuln_by_risk").getContext("2d");myChart=new Chart(n,o)}document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelectorAll('input[type="radio"]');t.forEach((t=>{t.addEventListener("change",(function(){fetchReportAndDrawChart(this.value)}))}));fetchReportAndDrawChart(t[0].value)}));