function fetchReportAndGeneratePivotTable(t){fetch(`/uploads/nessus/${t}_betdsi.json`).then((t=>t.json())).then((t=>{renderPivotTable(processJsonData(t.alert_report))})).catch((t=>console.error("Error fetching or parsing data:",t)))}function processJsonData(t){const e={};return t.forEach((t=>{const o=t.target_affected,n=t.risk_category;e[o]||(e[o]={Critical:0,High:0,Medium:0,Low:0,Informational:0}),e[o][n]++})),e}function renderPivotTable(t){const e=document.getElementById("vuln_by_target");e.innerHTML='<table class="table table-striped"><thead><tr><th style="background-color: #002d74; color: white;">Host</th><th style="background-color: rgba(112,48,160,0.7);">Critical</th><th style="background-color: rgba(192,1,0,0.7);">High</th><th style="background-color: rgba(255,153,50,0.7);">Medium</th><th style="background-color: rgba(255,204,3,0.7);">Low</th><th style="background-color: rgba(153,204,2,0.7);">Informational</th></tr></thead><tbody></tbody></table>';const o=e.querySelector("tbody");Object.keys(t).sort(((e,o)=>{const n=Object.values(t[e]).reduce(((t,e)=>t+e),0);return Object.values(t[o]).reduce(((t,e)=>t+e),0)-n})).slice(0,10).forEach((e=>{const n=document.createElement("tr");n.innerHTML=`<td>${e}</td>`;["Critical","High","Medium","Low","Informational"].forEach((o=>{const r=document.createElement("td");r.textContent=t[e][o]||0,n.appendChild(r)})),o.appendChild(n)}))}document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelectorAll('input[type="radio"]');t.forEach((t=>{t.addEventListener("change",(function(){fetchReportAndGeneratePivotTable(this.value)}))}));fetchReportAndGeneratePivotTable(t[0].value)})),document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelectorAll('input[type="radio"][name="report"]'),e=document.querySelectorAll(".reportId");function o(){var t=document.querySelector('input[type="radio"][name="report"]:checked');if(t){var o=t.value;e.forEach((function(t){t.textContent=o}))}}o(),t.forEach((function(t){t.addEventListener("change",(function(){o()}))}))}));