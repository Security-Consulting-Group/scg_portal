function getOSCounts(a){const t={};return a.forEach((a=>{const r=a.os;t[r]||(t[r]=0),t[r]++})),t}function calculateCounts(a){const t={Critical:0,High:0,Medium:0,Low:0,Informational:0};return a.forEach((a=>{t[a.risk_category]++})),t}function drawChart(a,t){a.chart&&a.chart.destroy();const r=Object.keys(t),o=Object.values(t),e={Critical:"rgba(112,48,160,0.5)",High:"rgba(192,1,0,0.5)",Medium:"rgba(255,153,50,0.5)",Low:"rgba(255,204,3,0.5)",Informational:"rgba(153,204,2,0.5)"},n={type:"bar",data:{labels:r,datasets:[{data:o,backgroundColor:r.map((a=>e[a])),borderWidth:1,borderColor:["rgb(112,48,160)","rgb(192,1,0)","rgb(255,153,50)","rgb(255,204,3)","rgb(153,204,2)"],barThickness:40}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{stacked:!0,ticks:{beginAtZero:!0,color:"black"},grid:{color:"rgba(0, 0, 0, 0.1)"}},y:{stacked:!0,ticks:{color:"black"},grid:{color:"rgba(0, 0, 0, 0.1)"}}},layout:{padding:{left:5,right:50,top:0,bottom:0}}}};Chart.defaults.font.size=12,a.chart=new Chart(a,n)}function drawPieChart(a,t){a.chart&&a.chart.destroy();const r={type:"pie",data:{labels:Object.keys(t),datasets:[{data:Object.values(t),backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(54, 162, 235, 0.5)","rgba(255, 206, 86, 0.5)","rgba(75, 192, 192, 0.5)","rgba(153, 102, 255, 0.5)","rgba(255, 159, 64, 0.5)","rgba(231,233,237,0.5)","rgba(255,205,210,0.5)","rgba(121,134,203,0.5)","rgba(220,231,117,0.5)"]}]},options:{responsive:!0,maintainAspectRatio:!1}};a.chart=new Chart(a,r)}window.getOSCounts=getOSCounts,window.calculateCounts=calculateCounts,window.drawChart=drawChart,window.drawPieChart=drawPieChart;